â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš€ IBIKI SMS v14.1 - COMPLETE PACKAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ PACKAGE: ibiki-sms-v14.1.tar.gz (204KB)
ğŸ¯ FIXES: Admin dashboard + Message status endpoint
âš¡ TIME: 5 minutes

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… WHAT v14.1 FIXES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FIX #1: Admin Dashboard Shows Clients
--------------------------------------
PROBLEM:
  âœ— Created users but admin dashboard shows empty table
  âœ— Can't see clients to allocate credits
  âœ— "Failed to fetch clients" error

SOLUTION:
  âœ… Database schema synchronized
  âœ… Missing "sender_phone_number" column added
  âœ… Admin dashboard now loads all clients
  âœ… Can allocate credits and manage clients

FIX #2: Message Status Endpoint
--------------------------------
PROBLEM:
  âœ— No way to check message delivery status from dashboards
  âœ— Existing endpoint only worked with API keys
  âœ— Missing for both admin and client dashboards
  âœ— Your clients can't check status through passthrough

SOLUTION:
  âœ… New endpoint: GET /api/dashboard/sms/status/{messageId}
  âœ… JWT-authenticated for dashboard use
  âœ… Works for both admin and client dashboards
  âœ… Existing API key endpoint still works for external clients
  âœ… Fetches latest status from ExtremeSMS
  âœ… Updates local database automatically
  âœ… Falls back to cached status if ExtremeSMS unavailable

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ†• NEW ENDPOINTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Dashboard Endpoint (NEW!)
--------------------------
GET /api/dashboard/sms/status/{messageId}

Authentication: JWT Bearer token (from login)
Access Control:
  - Admins: Can check any message
  - Clients: Can only check their own messages

Example Request:
  GET /api/dashboard/sms/status/MBT1aX5M6xc15h-6P.00.wbev
  Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6...

Example Response:
  {
    "success": true,
    "messageId": "MBT1aX5M6xc15h-6P.00.wbev",
    "status": "delivered",
    "statusDescription": "delivered"
  }

Statuses:
  - "queued" - Waiting to send
  - "sent" - Sent to carrier
  - "delivered" - Delivered to recipient
  - "failed" - Failed to send

---

API Endpoint (Existing - Enhanced)
-----------------------------------
GET /api/v2/sms/status/{messageId}

Authentication: API Key (your_api_key)
Access Control:
  - Clients can only check their own messages
  - Now includes ownership verification
  - Now updates local database with latest status

Example Request:
  GET /api/v2/sms/status/MBT1aX5M6xc15h-6P.00.wbev
  Authorization: Bearer ibk_live_...

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âš¡ QUICK DEPLOYMENT (5 STEPS)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1ï¸âƒ£ UPLOAD:
   scp ibiki-sms-v14.1.tar.gz root@151.243.109.79:/root/

2ï¸âƒ£ SSH:
   ssh root@151.243.109.79

3ï¸âƒ£ EXTRACT:
   cd /root
   tar -xzf ibiki-sms-v14.1.tar.gz
   cd ibiki-sms-v14.1-deploy

4ï¸âƒ£ DEPLOY:
   chmod +x deploy-v14.1.sh
   ./deploy-v14.1.sh

5ï¸âƒ£ VERIFY:
   - PM2 shows "ibiki-sms | online"
   - Admin dashboard shows clients
   - Status endpoint works

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… VERIFY DEPLOYMENT WORKED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. PM2 Running:
   pm2 status
   âœ… Should show: ibiki-sms | online

2. Logs Clean:
   pm2 logs ibiki-sms --lines 30
   âœ… Should show: "serving on port 5000"
   âœ… Should NOT show: errors about "sender_phone_number"

3. Admin Dashboard:
   - Open http://151.243.109.79
   - Login as admin
   - Go to "Clients" tab
   âœ… Should see: test@example.com with $50.00 credits

4. Status Endpoint:
   - From admin or client dashboard
   - Get JWT token from browser devtools
   - Test with:
     curl http://151.243.109.79/api/dashboard/sms/status/MESSAGE_ID \
       -H "Authorization: Bearer YOUR_JWT_TOKEN"
   âœ… Should return status JSON

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¯ WHO CAN USE WHAT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ADMIN (You):
  Dashboard:
    âœ… See all clients
    âœ… Allocate credits to clients
    âœ… View all message statuses
    âœ… Check status: GET /api/dashboard/sms/status/:messageId (JWT)
    âœ… Assign phone numbers
    âœ… Monitor system activity

CLIENTS (Ibiki Users):
  Dashboard:
    âœ… See their credit balance
    âœ… See their per-SMS rate
    âœ… Send SMS messages
    âœ… Check status: GET /api/dashboard/sms/status/:messageId (JWT)
    âœ… View their message history
  
  API (Programmatic):
    âœ… Send SMS via API
    âœ… Check status: GET /api/v2/sms/status/:messageId (API Key)
    âœ… Check balance
    âœ… Get inbox

YOUR CLIENTS (External API Users):
  API Only:
    âœ… Send SMS: POST /api/v2/sms/send
    âœ… Check status: GET /api/v2/sms/status/:messageId
    âœ… Check balance: GET /api/v2/account/balance
    âœ… Full passthrough to ExtremeSMS

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’¾ DATA SAFETY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… All users preserved (admin and clients)
âœ… All credits balances preserved
âœ… All API keys preserved
âœ… All message logs preserved
âœ… All system configuration preserved

Changes Made:
  + Added database column: sender_phone_number
  + Added new endpoint: /api/dashboard/sms/status/:messageId
  + Enhanced existing endpoint with ownership checks
  + Added database status update functionality

NO data is deleted or lost!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ‰ USE CASES ENABLED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Client Support
   - Client calls asking about message delivery
   - Admin checks status instantly from dashboard
   - No need to login to ExtremeSMS

2. Client Self-Service
   - Clients check their own message statuses
   - Reduces support tickets
   - Better user experience

3. External Integration
   - Your clients integrate status checks
   - Automated delivery tracking
   - Webhook alternatives

4. Analytics & Monitoring
   - Track delivery rates across clients
   - Identify problematic carriers
   - Monitor system health

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”§ TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Clients still not showing:
  cd /root/ibiki-sms
  npm run db:push --force
  pm2 restart ibiki-sms

Status endpoint returns 404:
  # Make sure using correct endpoint:
  /api/dashboard/sms/status/:messageId (for dashboards)
  /api/v2/sms/status/:messageId (for API clients)

Status returns "Message not found":
  # Message must exist in your database
  # Check with: 
  SELECT * FROM message_logs WHERE message_id = 'YOUR_ID';

Port 5000 in use:
  lsof -ti:5000 | xargs kill -9
  ./deploy-v14.1.sh

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ QUICK REFERENCE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Commands:
  Status:     pm2 status
  Logs:       pm2 logs ibiki-sms --lines 50
  Restart:    pm2 restart ibiki-sms
  Migrate:    cd /root/ibiki-sms && npm run db:push
  Database:   PGPASSWORD=Cosmic4382 psql -U ibiki_user -d ibiki_sms

Test Endpoints:
  # Get JWT token from browser devtools after login
  # Then test status:
  
  TOKEN="your_jwt_token"
  MESSAGE_ID="MBT1aX5M6xc15h-6P.00.wbev"
  
  curl http://151.243.109.79/api/dashboard/sms/status/$MESSAGE_ID \
    -H "Authorization: Bearer $TOKEN"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DOWNLOAD: ibiki-sms-v14.1.tar.gz and deploy in 5 minutes!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
